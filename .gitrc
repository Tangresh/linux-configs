# git aliases
alias tiga="tig --all"
alias gitka="gitk --all &"
alias qgita="qgit --all &"
alias gg="qgit --all &"
alias gst="git status"
alias gai="git add -i"
alias gci="git commit"
alias gco="git checkout"
alias gre="git rebase"
# git svn
alias gsr="git svn rebase"
alias gsf="git svn fetch"

         RED="\[\033[0;31m\]"
       GREEN="\[\033[0;32m\]"
      YELLOW="\[\033[0;33m\]"
        BLUE="\[\033[0;34m\]"
       WHITE="\[\033[1;37m\]"
   LIGHT_RED="\[\033[1;31m\]"
 LIGHT_GREEN="\[\033[1;32m\]"
LIGHT_YELLOW="\[\033[1;33m\]"
  LIGHT_BLUE="\[\033[1;34m\]"
  LIGHT_GRAY="\[\033[0;37m\]"
  COLOR_NONE="\[\e[0m\]"

function parse_git_branch {
	git rev-parse --git-dir &> /dev/null
	git_status="$(git status 2> /dev/null)"
	branch_pattern="^# On branch ([^${IFS}]*)"
	detached_branch_pattern="# Not currently on any branch"
	ahead_pattern="# Your branch is ahead of"
	behind_pattern="# Your branch is behind"
	diverge_pattern="# Your branch and (.*) have diverged"

	if [[ ${git_status}} =~ "Changes to be committed" ]]; then
		state="${GREEN}⚡"
	fi
	if [[ ${git_status}} =~ "Changes not staged for commit" ]]; then
		state=${state}"${RED}⚡"
	fi
	# add an else if or two here if you want to get more specific
	if [[ ${git_status} =~ ${ahead_pattern} ]]; then
		remote="${YELLOW}↑"
	fi
	if [[ ${git_status} =~ ${behind_pattern} ]]; then
		remote="${YELLOW}↓"
	fi
	if [[ ${git_status} =~ ${diverge_pattern} ]]; then
		remote="${YELLOW}↕"
	fi
	if [[ ${git_status} =~ ${branch_pattern} ]]; then
		branch=${YELLOW}"("${BASH_REMATCH[1]}")"
	elif [[ ${git_status} =~ ${detached_branch_pattern} ]]; then
		branch="${YELLOW}NO BRANCH"
	fi

	if [[ ${#state} -gt "0" || ${#remote} -gt "0" ]]; then
		s=" "
	fi

	echo "${branch}${s}${remote}${state}"
}


#PS1="\[\033[01;33m\]\D{%Y-%m-%d %H:%M} \[\033[01;32m\]\u@\h\[\033[01;34m\] \w \$\[\033[00m\] "
function prompt_func() {
	git rev-parse --git-dir > /dev/null 2>&1
	if [ $? -eq 0 ]; then
		PS1="${YELLOW}\D{%Y-%m-%d %H:%M} ${GREEN}\u${LIGHT_GREEN}@\h${LIGHT_BLUE} \w $(parse_git_branch) ${LIGHT_BLUE}\$${COLOR_NONE} "
#		PS1="${YELLOW}\D{%Y-%m-%d %H:%M} ${GREEN}\u${LIGHT_GREEN}@\h${LIGHT_BLUE} \w `__git_ps1` \$${COLOR_NONE} "
	else
		PS1="${YELLOW}\D{%Y-%m-%d %H:%M} ${GREEN}\u${LIGHT_GREEN}@\h${LIGHT_BLUE} \w \$${COLOR_NONE} "
	fi
}
PROMPT_COMMAND=prompt_func
