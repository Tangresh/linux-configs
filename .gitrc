# git aliases
alias tiga="tig --all"
alias gitka="gitk --all &"
alias qgita="qgit --all &"
alias gg="qgit --all &"
alias gst="git status"
alias gai="git add -i"
# git svn
alias gsr="git svn rebase"
alias gsf="git svn fetch"

cStdBranch=${LIGHT_YELLOW}
cChanges=${GREEN}
cUnstaged=${RED}

function parse_git_branch {
	git rev-parse --git-dir &> /dev/null
	git_status="$(git status 2> /dev/null)"
	branch_pattern="^On branch ([^${IFS}]*)"
	detached_branch_pattern="# Not currently on any branch"
	ahead_pattern="Your branch is ahead of"
	behind_pattern="Your branch is behind"
	diverge_pattern="Your branch and (.*) have diverged"

	if [[ ${git_status}} =~ "Changes to be committed" ]]; then
		state="${cChanges}⚡"
	fi
	if [[ ${git_status}} =~ "Changes not staged for commit" ]]; then
		state=${state}"${cUnstaged}⚡"
	fi
	# add an else if or two here if you want to get more specific
	if [[ ${git_status} =~ ${ahead_pattern} ]]; then
		remote="${cStdBranch}↑"
	fi
	if [[ ${git_status} =~ ${behind_pattern} ]]; then
		remote="${cStdBranch}↓"
	fi
	if [[ ${git_status} =~ ${diverge_pattern} ]]; then
		remote="${cStdBranch}↕"
	fi
	if [[ ${git_status} =~ ${branch_pattern} ]]; then
		branch=${cStdBranch}"("${BASH_REMATCH[1]}")"
	elif [[ ${git_status} =~ ${detached_branch_pattern} ]]; then
		branch="${cStdBranch}NO BRANCH"
	fi

	if [[ ${#state} -gt "0" || ${#remote} -gt "0" ]]; then
		s=" "
	fi

	echo "${branch}${s}${remote}${state}"
}


function git_prompt() {
    git rev-parse --git-dir > /dev/null 2>&1
    if [ $? -eq 0 ]; then
        gitPrompt="$(parse_git_branch)"
        #gitPrompt="`__git_ps1`"
    else
        gitPrompt=""
    fi
    echo ${gitPrompt}
}
